http.request.uri.path matches "/autodiscover\.(xml|src)$"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`path`:Ident
`matches`:OpMatches
`"/autodiscover\.(xml|src)$"`:String
###############################
host eq "www.example.com" and not cf.edge.server_port in {80 443}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`host`:Ident
`eq`:OpEq
`"www.example.com"`:String
`and`:OpAnd
`not`:Not
`cf`:Ident
`.`:Dot
`edge`:Ident
`.`:Dot
`server_port`:Ident
`in`:OpIn
`{`:BraceOpen
`80`:Number
`443`:Number
`}`:BraceClose
###############################
http.request.uri.path eq "/articles/2008/"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`path`:Ident
`eq`:OpEq
`"/articles/2008/"`:String
###############################
ip.src ne 93.184.216.0
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`ip`:Ident
`.`:Dot
`src`:Ident
`ne`:OpNEq
`93.184.216.0`:IPv4
###############################
cf.threat_score lt 10
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`cf`:Ident
`.`:Dot
`threat_score`:Ident
`lt`:OpLt
`10`:Number
###############################
cf.threat_score le 20
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`cf`:Ident
`.`:Dot
`threat_score`:Ident
`le`:OpLtEq
`20`:Number
###############################
cf.threat_score gt 25
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`cf`:Ident
`.`:Dot
`threat_score`:Ident
`gt`:OpGt
`25`:Number
###############################
cf.threat_score ge 60
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`cf`:Ident
`.`:Dot
`threat_score`:Ident
`ge`:OpGtEq
`60`:Number
###############################
http.request.uri.path contains "/articles/"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`path`:Ident
`contains`:OpContains
`"/articles/"`:String
###############################
http.request.uri.path matches "^/articles/200[7-8]/$"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`path`:Ident
`matches`:OpMatches
`"^/articles/200[7-8]/$"`:String
###############################
ip.src in { 93.184.216.0 93.184.216.1/3 }
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`{`:BraceOpen
`93.184.216.0`:IPv4
`93.184.216.1/3`:Ipv4Cidr
`}`:BraceClose
###############################
not ( http.host eq "www.cloudflare.com" and ip.src in 93.184.216.0/24 ) 
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`not`:Not
`(`:ParOpen
`http`:Ident
`.`:Dot
`host`:Ident
`eq`:OpEq
`"www.cloudflare.com"`:String
`and`:OpAnd
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`93.184.216.0/24`:Ipv4Cidr
`)`:ParClose
###############################
http.host eq "www.cloudflare.com" and ip.src in 93.184.216.0/24
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`host`:Ident
`eq`:OpEq
`"www.cloudflare.com"`:String
`and`:OpAnd
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`93.184.216.0/24`:Ipv4Cidr
###############################
http.host eq "www.cloudflare.com" xor ip.src in 93.184.216.0/24
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`host`:Ident
`eq`:OpEq
`"www.cloudflare.com"`:String
`xor`:OpXor
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`93.184.216.0/24`:Ipv4Cidr
###############################
http.host eq "www.cloudflare.com" or ip.src in 93.184.216.0/24
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`host`:Ident
`eq`:OpEq
`"www.cloudflare.com"`:String
`or`:OpOr
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`93.184.216.0/24`:Ipv4Cidr
###############################
(
 (http.host eq "api.example.com" and http.request.uri.path eq "/api/v2/auth") or
 (http.host matches "^(www|store|blog)\.example.com" and http.request.uri.path contains "wp-login.php") or
 ip.geoip.country in {"CN" "TH" "US" "ID" "KR" "MY" "IT" "SG" "GB"} or ip.geoip.asnum in {12345 54321 11111}
) and not ip.src in {11.22.33.0/24}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`(`:ParOpen
`(`:ParOpen
`http`:Ident
`.`:Dot
`host`:Ident
`eq`:OpEq
`"api.example.com"`:String
`and`:OpAnd
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`path`:Ident
`eq`:OpEq
`"/api/v2/auth"`:String
`)`:ParClose
`or`:OpOr
`(`:ParOpen
`http`:Ident
`.`:Dot
`host`:Ident
`matches`:OpMatches
`"^(www|store|blog)\.example.com"`:String
`and`:OpAnd
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`path`:Ident
`contains`:OpContains
`"wp-login.php"`:String
`)`:ParClose
`or`:OpOr
`ip`:Ident
`.`:Dot
`geoip`:Ident
`.`:Dot
`country`:Ident
`in`:OpIn
`{`:BraceOpen
`"CN"`:String
`"TH"`:String
`"US"`:String
`"ID"`:String
`"KR"`:String
`"MY"`:String
`"IT"`:String
`"SG"`:String
`"GB"`:String
`}`:BraceClose
`or`:OpOr
`ip`:Ident
`.`:Dot
`geoip`:Ident
`.`:Dot
`asnum`:Ident
`in`:OpIn
`{`:BraceOpen
`12345`:Number
`54321`:Number
`11111`:Number
`}`:BraceClose
`)`:ParClose
`and`:OpAnd
`not`:Not
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`{`:BraceOpen
`11.22.33.0/24`:Ipv4Cidr
`}`:BraceClose
###############################
"^(www|store|blog)\.example\.com"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`"^(www|store|blog)\.example\.com"`:String
###############################
(http.request.uri.query contains "token-type=\"JWT\"")
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`(`:ParOpen
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`uri`:Ident
`.`:Dot
`query`:Ident
`contains`:OpContains
`"token-type=\"JWT\""`:String
`)`:ParClose
###############################
ssl
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`ssl`:Ident
###############################
not ssl
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`not`:Not
`ssl`:Ident
###############################
http.request.headers.names[*] == "Content-Type"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`headers`:Ident
`.`:Dot
`names`:Ident
`[`:BracketOpen
`*`:Star
`]`:BracketClose
`=`:OpEq
`"Content-Type"`:String
###############################
any(http.request.headers.names[*] == "Content-Type")
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`any`:Ident
`(`:ParOpen
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`headers`:Ident
`.`:Dot
`names`:Ident
`[`:BracketOpen
`*`:Star
`]`:BracketClose
`=`:OpEq
`"Content-Type"`:String
`)`:ParClose
###############################
(ip.src in $office_network)
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`(`:ParOpen
`ip`:Ident
`.`:Dot
`src`:Ident
`in`:OpIn
`$`:Dollar
`office_network`:Ident
`)`:ParClose
###############################
lower(http.host) == "www.cloudflare.com"
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`lower`:Ident
`(`:ParOpen
`http`:Ident
`.`:Dot
`host`:Ident
`)`:ParClose
`=`:OpEq
`"www.cloudflare.com"`:String
###############################
to_string(cf.bot_management.score) == '5'
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`to_string`:Ident
`(`:ParOpen
`cf`:Ident
`.`:Dot
`bot_management`:Ident
`.`:Dot
`score`:Ident
`)`:ParClose
`=`:OpEq
`'5'`:String
###############################
to_string(ssl) == 'true'
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`to_string`:Ident
`(`:ParOpen
`ssl`:Ident
`)`:ParClose
`=`:OpEq
`'true'`:String
###############################
any(url_decode(http.request.body.form.values[*])[*] contains "an xss attack")
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`any`:Ident
`(`:ParOpen
`url_decode`:Ident
`(`:ParOpen
`http`:Ident
`.`:Dot
`request`:Ident
`.`:Dot
`body`:Ident
`.`:Dot
`form`:Ident
`.`:Dot
`values`:Ident
`[`:BracketOpen
`*`:Star
`]`:BracketClose
`)`:ParClose
`[`:BracketOpen
`*`:Star
`]`:BracketClose
`contains`:OpContains
`"an xss attack"`:String
`)`:ParClose